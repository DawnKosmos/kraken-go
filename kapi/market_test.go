package kapi

import (
	"fmt"
	jsoniter "github.com/json-iterator/go"
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestMarket(t *testing.T) {
	var call []byte = []byte(`{"error":[],"result":{"XXBTZUSD":[[1680912000,"27923.0","28170.0","27886.0","27956.0","28017.9","814.32026236",15890],[1680998400,"27955.9","28548.7","27812.2","28333.7","28203.8","1685.88383105",21294],[1681084800,"28333.8","29800.0","28170.0","29655.0","28945.8","5357.58172588",46175],[1681171200,"29654.9","30586.0","29615.0","30227.6","30115.2","5638.76555055",53246],[1681257600,"30227.7","30505.5","29645.8","29895.2","30057.5","4582.12074125",42996],[1681344000,"29895.2","30650.8","29873.9","30405.9","30303.3","3994.17529269",38636],[1681430400,"30406.0","31050.0","30000.0","30493.2","30611.9","5123.14673656",47027],[1681516800,"30493.2","30624.1","30250.0","30315.9","30379.7","1579.39907208",19921],[1681603200,"30315.9","30555.6","30145.0","30316.0","30341.6","1432.96396029",18436],[1681689600,"30316.1","30319.3","29777.0","29889.7","29947.6","1431.51497736",13735]],"last":1681603200}}`)
	var resp Response[Test]
	json := jsoniter.ConfigCompatibleWithStandardLibrary
	err := json.Unmarshal(call, &resp)
	assert.Nil(t, err)

	fmt.Println(resp)
}

type Test struct {
	Last int     `json:"last"`
	T    [][]any `json:""`
}
